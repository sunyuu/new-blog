<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>在JavaScript中引入类型的提案（翻译） | sunyuu</title>
    <meta name="description" content="A VitePress site">
    <link rel="stylesheet" href="/new-blog/assets/style.f7a1143a.css">
    <link rel="modulepreload" href="/new-blog/assets/app.99c73ab1.js">
    <link rel="modulepreload" href="/new-blog/assets/blog_article_article-2022-3-10.md.12734027.lean.js">
    
    <script>(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-b7788134><!--[--><!--]--><!--[--><span tabindex="-1" data-v-5bad87e6></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-5bad87e6> Skip to content </a><!--]--><!----><header class="VPNav no-sidebar" data-v-b7788134 data-v-0f827909><div class="VPNavBar" data-v-0f827909 data-v-10058498><div class="container" data-v-10058498><div class="VPNavBarTitle" data-v-10058498 data-v-477b2930><a class="title" href="/new-blog/" data-v-477b2930><!----><!--[-->Suny&#39;s Blog🚀<!--]--></a></div><div class="content" data-v-10058498><!----><!----><!----><div class="VPNavBarAppearance appearance" data-v-10058498 data-v-0b2f3bac><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-0b2f3bac data-v-741b6450 data-v-ab2de182><span class="check" data-v-ab2de182><span class="icon" data-v-ab2de182><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-741b6450><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-741b6450><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-10058498 data-v-5fe59986 data-v-0635fb1f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-0635fb1f><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-0635fb1f><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-0635fb1f><div class="VPMenu" data-v-0635fb1f data-v-e3d492a8><!----><!--[--><!--[--><!----><div class="group" data-v-5fe59986><div class="item appearance" data-v-5fe59986><p class="label" data-v-5fe59986>Appearance</p><div class="appearance-action" data-v-5fe59986><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-5fe59986 data-v-741b6450 data-v-ab2de182><span class="check" data-v-ab2de182><span class="icon" data-v-ab2de182><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-741b6450><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-741b6450><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-10058498 data-v-2ead6e10><span class="container" data-v-2ead6e10><span class="top" data-v-2ead6e10></span><span class="middle" data-v-2ead6e10></span><span class="bottom" data-v-2ead6e10></span></span></button></div></div></div><!----></header><!----><!----><div class="VPContent" id="VPContent" data-v-b7788134 data-v-09411f0c><div class="VPDoc" data-v-09411f0c data-v-5200d57a><div class="container" data-v-5200d57a><div class="aside" data-v-5200d57a><div class="aside-curtain" data-v-5200d57a></div><div class="aside-container" data-v-5200d57a><div class="aside-content" data-v-5200d57a><div class="VPDocAside" data-v-5200d57a data-v-ab3cfea0><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-ab3cfea0 data-v-0adf76b1><div class="content" data-v-0adf76b1><div class="outline-marker" data-v-0adf76b1></div><div class="outline-title" data-v-0adf76b1>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-0adf76b1><span class="visually-hidden" id="doc-outline-aria-label" data-v-0adf76b1> Table of Contents for current page </span><ul class="root" data-v-0adf76b1><!--[--><li style="" data-v-0adf76b1><a class="outline-link" href="#译者见解" data-v-0adf76b1>译者见解</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#译文" data-v-0adf76b1>译文</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-ab3cfea0></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-5200d57a><div class="content-container" data-v-5200d57a><!--[--><!--]--><main class="main" data-v-5200d57a><div style="position:relative;" class="vp-doc _new-blog_blog_article_article-2022-3-10" data-v-5200d57a><div><blockquote><p><a href="https://devblogs.microsoft.com/typescript/a-proposal-for-type-syntax-in-javascript/" target="_blank" rel="noopener noreferrer">英文原文链接</a> 作者为TypeScript团队成员</p></blockquote><h2 id="译者见解" tabindex="-1">译者见解 <a class="header-anchor" href="#译者见解" aria-hidden="true">#</a></h2><p>首先，当看到这篇文章的标题时，我很兴奋，想到终于来了，将来也许有机会可以写带类型的JavaScript了，所以我就很想把这篇文章翻译出来。 读完全篇后，虽然我觉得这个提案有积极的地方，但对此我仍然有以下几个疑问：</p><ul><li>添加了类型的JavaScipt仍然是TypeScript的子集，没法做到像TypeScript那么完善（因为TypeScript有许多运行时功能）</li><li>即使类型会被浏览器啊，node等JavaScript运行时完全忽略，但实际开发中我们仍然少不了构建的步骤，因为像Tree-Shaking、代码压缩、代码聚合等仍然需要构建工具，所以多一个转义的步骤并不会麻烦</li><li>类型的添加意外着JavaScript的代码量会变的很大，会导致前端资源变大</li></ul><p>但是，无论会遇到什么困难，我都认为这个提案是个积极的方向，是可以探索的方向，今天我们的前端开发体验正是由于前人的不断探索奠基的，其中很多也有先被摒弃的方案，但也一定会催生出更多的灵感火花，希望这个提案能够被大家认识，希望JavaScript越来越好用。</p><h2 id="译文" tabindex="-1">译文 <a class="header-anchor" href="#译文" aria-hidden="true">#</a></h2><p>今天我们兴奋的宣布一个新的stage-0的提案，那就是给JavaScript加上可选的和可去除的类型语法，新加的类型语法不会改变周围代码的运行，它会像注释一样运行，我们认为这个提案将会使TypeScript在各种规模的开发中便捷适用，我们想聊一聊为什么我们会提出这个提案，以及这个提案是如何实现的。</p><h3 id="背景" tabindex="-1">背景 <a class="header-anchor" href="#背景" aria-hidden="true">#</a></h3><p>最近我们团队在JavaScript的开发业界中的一个趋势是希望更快迭代和更少的构建步骤，换句话说就是在开发中“更快，更简单“。</p><p>某种程度上来说，现在开发过程已经在变的更加简便了。这是因为现代浏览器的快速开发迭代，对语言标准的支持程度，让我们开发者可以不通过编译现代版本的JavaScript来配合古老的浏览器运行环境。另外打包也是这样的，现代浏览器都支持使用module，所以打包可以看作是一种优化而不是必要步骤了，这种情况越来越普遍，对于TypeScript来说，如何跟上这种时代变化呢？</p><p>如果我们回到TypeScript刚刚发布的2012年，JavaScript世界和现在是截然不同的。当时我们不知道还要被低版本的Interne Explorer卡住多久，不清楚浏览器对语言的支持特性如何，这让我们当时青睐于使用编译器、打包器这样的工具。所以TypeScript能在那个年代快速成长，毕竟反正都要有编译打包的步骤，为什么不编译一个有类型的呢？但是随着时代发展，也许将来仅仅只有TypeScript需要编译了，其它特性都能原生支持，我们并不想TypeScript最后成为阻碍JavaScript发展的工具。</p><p>从某种程度来说，现在的JavaScripts是支持类型提示的。如果你用过Visual Studio或者Visual Studio Code，那么你可以用JSDoc注释的方式来标注类型。</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">a</span><span style="color:#676E95;font-style:italic;"> {number}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * </span><span style="color:#89DDFF;font-style:italic;">@</span><span style="color:#C792EA;font-style:italic;">param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">b</span><span style="color:#676E95;font-style:italic;"> {number}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> b</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">a</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">b</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>像上面这样的只是注释，不会干扰到代码的运行，但是编辑器里的TypeScript却可以用它们给开发者带来更好的开发体验，你甚至可以在文件顶部添加<code>// @ts-check</code>注释或者通过TypeScript编译时设置<code>checkJs</code>来启用类型检查，这个特性可以很方便不通过编译步骤就能获得一些TypeScript的特性，开发者可以在一些小型项目、基本的网页脚本或者服务端代码中使用。</p><p>但是你发现这还是有点冗长，有没什么方法让我们既能轻松便捷的编写JavaScript，又能获得TypeScript的开发体验呢，听起来有点鱼和熊掌不可兼得，但是，如果我们可以在JavaScript中使用TypeScript的类型语法，但是这些语法又像注释一样会在运行环境中被忽略。</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">add</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">a</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> b</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">number</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">a</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">b</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>我们团队相信这里面有一些实现的可能，所以这个月我们希望能给TC39（ECMAScript标准委员会）提交这个提案。</p><h3 id="如何工作" tabindex="-1">如何工作 <a class="header-anchor" href="#如何工作" aria-hidden="true">#</a></h3><p>当我们被问到什么时候类型系统会加到JavaScript中，我们没法准确的给出答复，历史来看，这个问题对开发者来说一直以来都有不同的答案，有些人认为类型应该完全被忽略掉，但有些人认为类型应该要有些实际意义，像是在运行时的验证，或者作为引擎优化的提示，等等其它用处。但最近几年，我们看到一些与TypeScript相配合的发展趋势，那就是类型在引擎运行时是完全忽略和可消除的。所以最近越来越多的我们团队的开发者多次向我们提过，让我们提出一种“注释型类型标注”的提案。</p><p>这个提案的具体想法是这样的，JavaScript中支持一种可以完全被引擎忽略的类型语法，这种语法在开发中可以被TypeScript、Flow以及其它工具识别使用。这可以让我们既保留TypeScript中一些好的开发体验，像是类型检查，又不需要通过编译步骤。</p><p><img src="https://sunyuu-1305462023.cos.ap-nanjing.myqcloud.com/blog/14618593506.png" alt="tac-announcement-today-proposed 1.png"> 同时，可以让TypeScript和JavaScript+Type在语法上和类型检查上保持相同的体验，可以在编辑器中实时的看到类型提示，可以在命令行中运行TypeScript检查，也可以把TypeScript运用在CI流程中，最大的不同在于 我们不需要编译了，我们将大大降低JavaScript开发人员体验类型的门槛。</p><p><img src="https://sunyuu-1305462023.cos.ap-nanjing.myqcloud.com/blog/14618593503.png" alt="tac-announcement-checking-behavior 1.png"></p><p>要想上面的方案实现，JavaScript至少要添加变量和函数类型注释语法，变量可选修饰符，类型声明语法，断言运算符等等。另外的像(public, private, and protected) 这类的语法也可能被包含，但还有一些像枚举，命名空间等就不在这次的提案中了，因为这些语法涉及到一些运行时行为。这些特性可以分别作为语言提案提交给ECMAScript标准委员会。总而言之，我们当前提案的目的是提供一个TypeScript的子集。</p><h3 id="这个提案不做什么" tabindex="-1">这个提案不做什么 <a class="header-anchor" href="#这个提案不做什么" aria-hidden="true">#</a></h3><p>我们有必要讲讲这个提案不会做什么。 我们团队不建议在每个浏览器和JavaScript运行时中添加TypeScript类型检查，同时我们也不建议加入新的类型检查到浏览器中，因为这会带来一系列的问题，像是运行时性能问题，兼容性问题等等。相对的我们提出与TypeScript兼容并且受其启发的语法，这可以被任何类型检查器使用，而且语法将被运行时忽略，我们觉得这个方案对各方面都有优势，可以让人们选择自己喜欢的类型检查器。</p><h3 id="接下来的事" tabindex="-1">接下来的事 <a class="header-anchor" href="#接下来的事" aria-hidden="true">#</a></h3><p>基于以上的，我们准备在这个月的TC39会议上把这个提案作为stage1提交上去，我们将在来自于Bloomberg的Rob Palmer 和来自于Igalia的Romulo Cintra的共同支持和指导下来完善这个提案。</p><p>如果这个提案能个进入stage1中，那么就代表TC39委员会是相信这么做是有一定的价值的。能不能进入satge1目前还不好下定论，我们相信到时委员会中会有很多有价值的意见，也会有一些质疑，像这样的提案会收到很多反馈和审查，在此过程中将会需要涉及大量的语言设计方面的更改，并且需要要话费多年才能看到结果。</p><p>但是，一旦我们完成了这一切，我们将会给JavaScript世界带来最具影响力的改进之一，对此我们很兴奋，也很期望。</p><p>最后，要感谢在这个过程中所有给予我们团队帮助的所有人，我们很荣幸是这个充满激情的开发世界中的一员。</p></div></div></main><footer class="VPDocFooter" data-v-5200d57a data-v-dd53704a><div class="edit-info" data-v-dd53704a><!----><!----></div><!----></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"blog_article_article-2018-2-5.md\":\"aa90c6f6\",\"blog_article_article-2018-2-7.md\":\"f150ec71\",\"blog_article_article-2018-3-13.md\":\"f69c1c10\",\"blog_article_article-2021-10-31.md\":\"a2423024\",\"blog_article_article-2022-3-10.md\":\"12734027\",\"index.md\":\"1733778b\"}")</script>
    <script type="module" async src="/new-blog/assets/app.99c73ab1.js"></script>
    
  </body>
</html>